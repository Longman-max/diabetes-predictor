<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home | Diabetes Predictor</title>
    <link
      rel="shortcut icon"
      href="../static/images/logo.jpeg"
      type="image/x-icon"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&display=swap"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <link rel="stylesheet" href="../static/css/style.css" />
    <link rel="stylesheet" href="../static/css/dark-mode.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-transparent shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center gap-2" href="#">
          <div class="pk-logo">
            <img src="../static/images/logo.jpeg" alt="Logo" />
          </div>
          <h1 style="margin: 0">Precious Kings</h1>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="collapse navbar-collapse justify-content-end"
          id="navbarSupportedContent"
        >
          <ul class="navbar-nav align-items-center gap-3">
            <li class="nav-item">
              <button
                type="button"
                id="simulate-btn"
                class="btn bg-white border d-flex align-items-center gap-1 simulate-btn"
                style="cursor: pointer"
                onclick="fillFields()"
              >
                <span style="color: #111">Simulate</span>
                <span
                  class="material-symbols-outlined"
                  style="font-size: 22px; color: #111"
                  >casino</span
                >
              </button>
            </li>

            <li>
              <a href="/about" class="about-btn-link">
                <button class="about-btn">About</button>
              </a>
            </li>

            <li class="nav-item">
              <button
                type="button"
                id="theme-toggle"
                class="btn d-flex align-items-center gap-1 theme-btn"
                style="
                  background: none;
                  border: none;
                  padding: 6px;
                  border-radius: 8px;
                  cursor: pointer;
                "
              >
                <span class="material-symbols-outlined" style="font-size: 22px"
                  >dark_mode</span
                >
              </button>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main>
      <h1>Diabetes Predictor</h1>

      <div class="two-column">
        <div class="form-box">
          <form id="prediction-form" method="post" action="/predict">
            <h3>Medical Information</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="Age"
                  >Age: <span class="clinical-range">(0-100)</span></label
                >
                <input type="number" name="Age" min="0" max="100" required />
              </div>
              <div class="form-group">
                <label for="Weight"
                  >Weight (kg):
                  <span class="clinical-range">(20-200)</span></label
                >
                <input
                  type="number"
                  name="Weight"
                  min="20"
                  max="200"
                  required
                />
              </div>
              <div class="form-group">
                <label for="Blood Glucose"
                  >Blood Glucose (mg/dL):
                  <span class="clinical-range">(50-400)</span></label
                >
                <input
                  type="number"
                  name="Blood Glucose"
                  min="50"
                  max="400"
                  required
                />
              </div>
              <div class="form-group">
                <label for="HbA1c"
                  >HbA1c (%):
                  <span class="clinical-range">(4.0-14.0)</span></label
                >
                <input
                  type="number"
                  step="0.1"
                  name="HbA1c"
                  min="4.0"
                  max="14.0"
                  required
                />
              </div>
              <div class="form-group">
                <label for="number_outpatient"
                  >Number of Outpatient Visits:
                  <span class="clinical-range">(0-50)</span></label
                >
                <input
                  type="number"
                  name="number_outpatient"
                  min="0"
                  max="50"
                  value="0"
                />
              </div>
              <div class="form-group">
                <label for="number_emergency"
                  >Number of Emergency Visits:
                  <span class="clinical-range">(0-20)</span></label
                >
                <input
                  type="number"
                  name="number_emergency"
                  min="0"
                  max="20"
                  value="0"
                />
              </div>
              <div class="form-group">
                <label for="number_inpatient"
                  >Number of Inpatient Visits:
                  <span class="clinical-range">(0-20)</span></label
                >
                <input
                  type="number"
                  name="number_inpatient"
                  min="0"
                  max="20"
                  value="0"
                />
              </div>
              <div class="form-group">
                <label for="num_medications"
                  >Number of Medications:
                  <span class="clinical-range">(0-50)</span></label
                >
                <input
                  type="number"
                  name="num_medications"
                  min="0"
                  max="50"
                  value="0"
                />
              </div>
              <div class="form-group">
                <label for="race">Race:</label>
                <select name="race" id="race" required>
                  <option value="Caucasian">Caucasian</option>
                  <option value="AfricanAmerican">African American</option>
                  <option value="Asian">Asian</option>
                  <option value="Hispanic">Hispanic</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="form-group">
                <label for="gender">Gender:</label>
                <select name="gender" id="gender" required>
                  <option value="Female">Female</option>
                  <option value="Male">Male</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>
            <button type="submit">Predict</button>
          </form>
        </div>

        <div class="prediction-box" id="result-box">
          <h3>Prediction Result</h3>
          <p class="status" id="status-text">Awaiting result...</p>
          <div class="progress-bar">
            <span id="progress-bar-span" style="width: 0%"></span>
          </div>
          <div class="health-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="60"
              height="60"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-briefcase-medical-icon lucide-briefcase-medical"
            >
              <path d="M12 11v4" />
              <path d="M14 13h-4" />
              <path d="M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2" />
              <path d="M18 6v14" />
              <path d="M6 6v14" />
              <rect width="20" height="14" x="2" y="6" rx="2" />
            </svg>
          </div>
          <div class="result-text-container">
            <p class="result-text" id="result-text">No prediction yet</p>
            <p class="advice-text" id="advice-text"></p>
          </div>
          <p class="instruction-text">
            Enter your medical information and click<span class="emphasis">
              "Predict"
            </span>
            to see your diabetes risk assessment.
          </p>
          <button type="button" id="clear-result-btn">Clear Result</button>
        </div>
      </div>
    </main>
    <script>
      document
        .getElementById("prediction-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const form = event.target;
          const formData = new FormData(form);

          document.getElementById("status-text").textContent = "Predicting...";
          document.getElementById("progress-bar-span").style.width = "50%";
          document.getElementById("result-text").textContent = "";
          document.getElementById("advice-text").textContent = "";
          document.getElementById("result-box").className = "prediction-box"; // Clear all classes

          fetch(form.action, {
            method: form.method,
            body: formData,
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              return response.json();
            })
            .then((data) => {
              const resultText = document.getElementById("result-text");
              const adviceText = document.getElementById("advice-text");
              const resultBox = document.getElementById("result-box");

              resultText.textContent = data.message;
              adviceText.textContent = data.advice;

              resultBox.classList.add(data.class_name);

              document.getElementById("status-text").textContent =
                "Prediction complete";
              document.getElementById("progress-bar-span").style.width = "100%";
            })
            .catch((error) => {
              console.error("Error:", error);
              document.getElementById("result-text").textContent =
                "An error occurred during prediction.";
              document.getElementById("advice-text").textContent = "";
              document.getElementById("status-text").textContent =
                "Prediction failed";
              document.getElementById("progress-bar-span").style.width = "0%";
            });
        });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script src="../static/js/script.js"></script>
    <script src="../static/js/theme.js"></script>
  </body>
</html>
